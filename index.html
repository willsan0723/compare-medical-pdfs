<html>
  <body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/1.10.100/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.6.347/pdf.worker.entry.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/1.10.100/pdf.worker.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <input
      type="file"
      id="file-id"
      name="file_name"
      onchange="ExtractText1();"
    />
    <input
      type="file"
      id="file-id2"
      name="file_name2"
      onchange="ExtractText2();"
    />

    <button onclick="ExtractNumbers();">Extract Numbers</button>

    <!-- a container for the output -->
    <div id="output"></div>
    <br />
    <hr />
    <br />
    <div id="output2"></div>
    <!-- <div id="output3">(801) 916-6611 (801) 916-2712</div> -->

    <script>
      var datass = "";
      var DataArr = [];
      PDFJS.workerSrc = "";

      function ExtractNumbers() {
        let output3 = document.getElementById("output").textContent;
        let output4 = document.getElementById("output2").textContent;
        let phone1 = output3.match(/(\(\d\d\d\)) (\d\d\d)\-(\d\d\d\d)/g);
        let phone2 = output4.match(/(\(\d\d\d\)) (\d\d\d)\-(\d\d\d\d)/g);
        console.log(phone1);
        console.log(phone2);
      }

      function ExtractText1() {
        var input = document.getElementById("file-id");
        var fReader = new FileReader();
        fReader.readAsDataURL(input.files[0]);
        // console.log(input.files[0]);
        fReader.onloadend = function (event) {
          convertDataURIToBinary(event.target.result);
        };
      }

      function ExtractText2() {
        var input = document.getElementById("file-id2");
        var fReader = new FileReader();
        fReader.readAsDataURL(input.files[0]);
        // console.log(input.files[0]);
        fReader.onloadend = function (event) {
          convertDataURIToBinary2(event.target.result);
        };
      }

      var BASE64_MARKER = ";base64,";

      function convertDataURIToBinary(dataURI) {
        var base64Index = dataURI.indexOf(BASE64_MARKER) + BASE64_MARKER.length;
        var base64 = dataURI.substring(base64Index);
        var raw = window.atob(base64);
        var rawLength = raw.length;
        var array = new Uint8Array(new ArrayBuffer(rawLength));

        for (var i = 0; i < rawLength; i++) {
          array[i] = raw.charCodeAt(i);
        }
        pdfAsArray(array);
      }

      function convertDataURIToBinary2(dataURI) {
        var base64Index = dataURI.indexOf(BASE64_MARKER) + BASE64_MARKER.length;
        var base64 = dataURI.substring(base64Index);
        var raw = window.atob(base64);
        var rawLength = raw.length;
        var array2 = new Uint8Array(new ArrayBuffer(rawLength));

        for (var i = 0; i < rawLength; i++) {
          array2[i] = raw.charCodeAt(i);
        }
        pdfAsArray2(array2);
      }

      function getPageText(pageNum, PDFDocumentInstance) {
        // Return a Promise that is solved once the text of the page is retrieven
        return new Promise(function (resolve, reject) {
          PDFDocumentInstance.getPage(pageNum).then(function (pdfPage) {
            // The main trick to obtain the text of the PDF page, use the getTextContent method
            pdfPage.getTextContent().then(function (textContent) {
              var textItems = textContent.items;
              var finalString = "";

              // Concatenate the string of the item to the final string
              for (var i = 0; i < textItems.length; i++) {
                var item = textItems[i];

                finalString += item.str + " ";
              }

              // Solve promise with the text retrieven from the page
              resolve(finalString);
            });
          });
        });
      }

      function pdfAsArray(pdfAsArray) {
        PDFJS.getDocument(pdfAsArray).then(
          function (pdf) {
            var pdfDocument = pdf;
            // Create an array that will contain our promises
            var pagesPromises = [];

            for (var i = 0; i < pdf.pdfInfo.numPages; i++) {
              // Required to prevent that i is always the total of pages
              (function (pageNumber) {
                // Store the promise of getPageText that returns the text of a page
                pagesPromises.push(getPageText(pageNumber, pdfDocument));
              })(i + 1);
            }

            // Execute all the promises
            Promise.all(pagesPromises).then(function (pagesText) {
              // Display text of all the pages in the console
              // e.g ["Text content page 1", "Text content page 2", "Text content page 3" ... ]
              console.log(pagesText); // representing every single page of PDF Document by array indexing
              console.log(pagesText.length);
              var outputStr = "";
              for (var pageNum = 0; pageNum < pagesText.length; pageNum++) {
                console.log(pagesText[pageNum]);
                outputStr = "";
                outputStr =
                  "<br/><br/>Page " + (pageNum + 1) + " contents <br/> <br/>";

                var div = document.getElementById("output");

                div.innerHTML += outputStr + pagesText[pageNum];
              }
            });
          },
          function (reason) {
            // PDF loading error
            console.error(reason);
          }
        );
      }

      function pdfAsArray2(pdfAsArray2) {
        PDFJS.getDocument(pdfAsArray2).then(
          function (pdf) {
            var pdfDocument = pdf;
            // Create an array that will contain our promises
            var pagesPromises = [];

            for (var i = 0; i < pdf.pdfInfo.numPages; i++) {
              // Required to prevent that i is always the total of pages
              (function (pageNumber) {
                // Store the promise of getPageText that returns the text of a page
                pagesPromises.push(getPageText(pageNumber, pdfDocument));
              })(i + 1);
            }

            // Execute all the promises
            Promise.all(pagesPromises).then(function (pagesText) {
              // Display text of all the pages in the console
              // e.g ["Text content page 1", "Text content page 2", "Text content page 3" ... ]
              console.log(pagesText); // representing every single page of PDF Document by array indexing
              console.log(pagesText.length);
              var outputStr = "";
              for (var pageNum = 0; pageNum < pagesText.length; pageNum++) {
                console.log(pagesText[pageNum]);
                outputStr = "";
                outputStr =
                  "<br/><br/>Page " + (pageNum + 1) + " contents <br/> <br/>";

                var div = document.getElementById("output2");

                div.innerHTML += outputStr + pagesText[pageNum];
              }
            });
          },
          function (reason) {
            // PDF loading error
            console.error(reason);
          }
        );
      }
    </script>
  </body>
</html>
